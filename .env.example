# EasyEnclave Control Plane Configuration

# Intel Trust Authority (ITA) Configuration
ITA_API_URL=https://api.trustauthority.intel.com/appraisal/v2
ITA_API_KEY=your_ita_api_key_here

# Cloudflare Tunnel Integration (optional)
CLOUDFLARE_API_TOKEN=
CLOUDFLARE_ACCOUNT_ID=
CLOUDFLARE_ZONE_ID=
EASYENCLAVE_DOMAIN=easyenclave.com

# Trusted MRTDs (comma-separated hex strings)
# Agent MRTD: Launcher agent measurement
TRUSTED_AGENT_MRTDS=abc123...,def456...
# Proxy MRTD: Proxy service measurement
TRUSTED_PROXY_MRTDS=789ghi...

# TCB Status Enforcement (Security Feature)
# Prevents registration of agents with known vulnerabilities
# Modes: strict (reject), warn (log warning), disabled (no check)
TCB_ENFORCEMENT_MODE=strict
# Allowed TCB statuses (comma-separated)
# Common values: UpToDate, SWHardeningNeeded, ConfigurationNeeded, OutOfDate
ALLOWED_TCB_STATUSES=UpToDate

# Nonce Challenge (Replay Attack Prevention)
# Requires agents to request one-time nonce before registration
# Modes: required (enforce), optional (warn), disabled (no check)
NONCE_ENFORCEMENT_MODE=required
# Nonce time-to-live in seconds (default: 5 minutes)
NONCE_TTL_SECONDS=300
# Nonce length in hex characters (default: 32 = 128 bits entropy)
NONCE_LENGTH=32

# Attestation Refresh Interval
# How often to request fresh attestation from agents (in seconds)
# Each refresh causes agent to call Intel Trust Authority API
# Set to 0 to disable periodic re-attestation (only verify on registration)
# Default: 3600 (1 hour) - balance between security and API usage
AGENT_ATTESTATION_INTERVAL=3600

# Stale Agent Cleanup
# Agents with no heartbeat for this many hours are automatically deleted
# Also cleans up their Cloudflare tunnels and DNS records
# Default: 24 hours
AGENT_STALE_HOURS=24

# Admin Authentication
# Generate with: python3 scripts/hash_admin_password.py
ADMIN_PASSWORD_HASH=

# GitHub OAuth (optional)
GITHUB_OAUTH_CLIENT_ID=
GITHUB_OAUTH_CLIENT_SECRET=
GITHUB_OAUTH_REDIRECT_URI=https://your-domain.com/auth/github/callback

# Stripe Payment Processing (optional)
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=

# Database (default: SQLite in current directory)
EASYENCLAVE_DB_PATH=easyenclave.db
